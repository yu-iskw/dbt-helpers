-- DO NOT EDIT THIS FILE DIRECTLY.
-- It was generated by dbt-helper=={{ context.dbt_helper_version }}.

{{ "{%% set gcp_project = var('projects')['%s'] %%}" | format(context.project_alias) }}
{{ "{%% set model_owner = '%s' %%}" | format(context.owner) }}

{% raw -%}
{{
{%- endraw %}
  config(
    enabled=true,
    full_refresh=none,
    materialized="{{ resource.config.get('materialized', 'view') }}",
    database=gcp_project,
    schema="{{ context.dataset }}",
    alias="{{ resource.name }}",
    persist_docs={"relation": true, "columns": true},
    labels={
      "modeled": "dbt",
      "contains_pii": "false",
      "owner": model_owner,
      {% for k, v in resource.meta.items() -%}
      {% if k != '_extraction_metadata' -%}
      "{{- k -}}": "{{- v -}}",
      {% endif -%}
      {% endfor -%}
    },
    tags=[
      {%- for tag in resource.tags %}
       '{{ tag }}',
      {%- endfor %}
    ],
  )
{%- raw %}
}}
{%- endraw %}

with source as (
    select * from {{ "{{ source('" ~ source_name ~ "', '" ~ resource.name ~ "') }}" }}
)

select * from source
